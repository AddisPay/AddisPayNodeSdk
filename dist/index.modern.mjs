function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},e.apply(this,arguments)}class t{constructor(e){this.baseUrl=void 0,this.baseUrl=e.baseUrl||"https://merchant.addispay.et/encrypt"}async encryptor(t,r){const o={data:{total_amount:t.total_amount,tx_ref:t.tx_ref,currency:t.currency,first_name:t.first_name,email:t.email?t.email:"test@gmail.com",phone_number:t.phone_number,last_name:t.last_name,session_expired:t.session_expired?t.session_expired:5e3,nonce:t.nonce,success_url:t.success_url?t.success_url:"https://checkout.addispay.et/",cancel_url:t.cancel_url?t.cancel_url:"http://localhost/cancel",error_url:t.error_url?t.error_url:"http://localhost/error/"},public_key:r},s=t.order_detail;try{const r=await fetch("https://merchant.addispay.et/encrypt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();return await this.createOrder(e({},a,{order_detail:s}),t)}catch(e){throw console.error("Error in encryptor:",e),e}}async createOrder(t,r){const o={data:e({},t.result,{order_detail:t.order_detail}),message:"gJkBFAJ+v5yPWvk4c149gV7b9pdwHcXZVa2nyQQQm8e4UB3VBFc6OpLi8rGfUHOezNMvIbkMQkJTrWZ/amxxRCMqhjKt33hKZDpRWXdQFRKitZY1+Fo+dEJslsYo4EG3SX/lQvXpVvkCZfWA+wRLmizoQ+c1YawAmHjQsQ6TQmSzoqEKJUzlDN902DEbD7cqA34jbpCbMd1XUpedSP780DYcxCDQjhJpYrQUJU67FuOKwHdD3zH//htnTI7D1NV4/DICRZngmiok+K+fI5aq3iKRN2xTuBl8vsFNtij2+AW8fuKHAi0Vj7wjo7qpoxUeduuLoi2+1hYL5J7D+1LW4g=="},s={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Auth:"af026758-109d-46f7-a48d-5048d977898b_1"},body:JSON.stringify(o)};try{const e=await fetch("https://checkoutapi.addispay.et/api/v1/encrypted/receive-data",s);if(console.log(e.status),!e.ok)throw new Error("Network response was not ok");const t=await e.json();return console.log({transaction_detail:r}),r.success_url?t.uuid:`${t.checkout_url}/${t.uuid}`}catch(e){console.error("problem on creating order:",e)}}async waterBillRequest(e){try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bill_id:e.bill_id,biller_id:"247580",serviceType:"Derash"})},r=await fetch("https://mi.addispay.et/api/v1/request_services",t),o=await r.json();return console.log(o),console.log({port:process.env.PORT}),o.message}catch(e){return console.error("Error:",e),{Error:e}}}}class r extends t{}var o;o=r,[class extends t{payNow(e,t){return this.encryptor(e,t)}askBill(e){return this.waterBillRequest(e)}}].forEach(e=>{Object.getOwnPropertyNames(e.prototype).forEach(t=>{Object.defineProperty(o.prototype,t,Object.getOwnPropertyDescriptor(e.prototype,t)||Object.create(null))})});export{r as default};
